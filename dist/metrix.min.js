if(void 0===MetrixAnalytics){var MetrixAnalytics=function(e){if(!(this instanceof MetrixAnalytics))return new MetrixAnalytics(config);this.setChartId(e.appId),e=e||{},this.options={trackPageView:!0},this.initialize(e)};!function(e){var t={urlEvents:"https://analytics.metrix.ir/v2/events",urlInit:"https://analytics.metrix.ir/v2/init",timeOut:5e3,queueUnloadTime:1e4,sessionExpireTime:6e4,queueCapacity:15,localQueueCapacity:200},n={start:"start",stop:"stop",unused:"unused"},r=null,i=null,a=null,o=null,s=null,u=null,c=null,l=0,g=document.location.pathname,d=n.unused,m=null,f=null,h=null,p="not recognized",v={authentication:"X-Application-Id",contentType:"Content-Type",ContentTypeValue:"application/json;charset=UTF-8"},S={maneQueue:"METRIX_LOCAL_OBJECT_QUEUE",subQueue:"METRIX_LOCAL_SUB_QUEUE",sessionLastVisitTime:"METRIX_LAST_VISIT_TIME",sessionDurationVisitTime:"METRIX_DIFFERENT_VISIT_TIME",referrerPath:"METRIX_REFERRER_PATH",userId:"METRIX_USER_ID",sessionNumber:"METRIX_SESSION_NUMBER",sessionId:"METRIX_SESSION_ID",sessionLastUs:"METRIX_LAST_SESSION_ID_USED",metrixId:"METRIX_CHART_CLIENT_ID",lastTrySendData:"METRIX_LAST_TRY_SEND_DATA_TIME",lastTimeDataSend:"METRIX_LAST_SEND_DATA_TIME",ajaxState:"METRIX_AJAX_STATE"};window.addEventListener&&window.addEventListener("message",function(e){try{var t=JSON.parse(e.data);switch(t.type){case"metrix_client_id":"NULL"!=(n=t.value)&&function(e,t,n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var i="expires="+r.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"}(S.metrixId,n,999)}}catch(e){}var n},!1);var I={};I.isClientIdValid=function(){return"NULL"!=function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return"NULL"}(S.metrixId)},I.findMetrixId=function(){},I.setMetrixId=function(e){localStorage.setItem(S.metrixId,e)};var y={setSessionLastVisitTime:function(){var e=new Date,t=parseInt(Date.parse(e))+e.getMilliseconds();localStorage.setItem(S.sessionLastVisitTime,t.toString())},setSessionDiffVisitTime:function(){localStorage.setItem(S.sessionDurationVisitTime,0),this.setSessionLastVisitTime()},lastVisit:function(){return localStorage.getItem(S.sessionLastVisitTime)},diffVisit:function(){return localStorage.getItem(S.sessionDurationVisitTime)},addSessionVisitTime:function(){var e=new Date,t=(parseInt(Date.parse(e))+e.getMilliseconds()).toString()-this.lastVisit(),n=parseInt(this.diffVisit())+parseInt(t);localStorage.setItem(S.sessionDurationVisitTime,n.toString())}},b={};function w(){metrixSessionId.sessionIsStarted&&(y.addSessionVisitTime(),N(metrixEvent.sessionStop()),y.setSessionDiffVisitTime(),N(metrixEvent.sessionStart()))}b.copyFields=function(e,t){var n,r,i=function(e,t){return function(){return t.apply(e,arguments)}};for(n in t=t||{},e)/layerX|Y/.test(n)||(r=e[n],t[n]="function"==typeof r?i(e,r):r);return t},b.merge=function(e,t){var n,r,i;if(void 0===e)return e;if(void 0===t)return e;if(e instanceof Array&&t instanceof Array){for(n=[],i=0;i<e.length;i++)n.push(e[i]);for(i=0;i<t.length;i++)n.length>i?n[i]=b.merge(n[i],t[i]):n.push(t[i]);return n}if(e instanceof Object&&t instanceof Object){for(r in n={},e)n[r]=e[r];for(r in t)void 0!==n[r]?n[r]=b.merge(n[r],t[r]):n[r]=t[r];return n}return t},b.toObject=function(e){var t,n={};for(t in e)n[t]=e[t];return n},b.genGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},b.getQueryString=function(e){return e.length>0?"?"===e.charAt(0)?e.substring(1):e:null},b.parseQueryString=function(e){var t={};if(e.length>0){var n="?"===e.charAt(0)?e.substring(1):e;if(n.length>0)for(var r=n.split("&"),i=0;i<r.length;i++)if(r[i].length>0){var a=r[i].split("=");try{var o=decodeURIComponent(a[0]),s=a.length>1?decodeURIComponent(a[1]):"true";t[o]=s}catch(e){}}}return t},b.unparseQueryString=function(e){var t,n,r=[];for(t in e)e.hasOwnProperty&&!e.hasOwnProperty(t)||(n=e[t],r.push(encodeURIComponent(t)+"="+encodeURIComponent(n)));var i=r.join("&");return i.length>0?"?"+i:""},b.size=function(e){if(void 0===e)return 0;if(e instanceof Array)return e.length;if(e instanceof Object){var t=0;for(var n in e)e.hasOwnProperty&&!e.hasOwnProperty(n)||++t;return t}return 1},b.mapJson=function(e,t){var n,r;if(e instanceof Array){n=[];for(var i=0;i<e.length;i++)r=b.mapJson(e[i],t),b.size(r)>0&&n.push(r);return n}if(e instanceof Object){for(var a in n={},e)r=b.mapJson(e[a],t),b.size(r)>0&&(n[a]=r);return n}return t(e)},b.jsonify=function(e){return b.mapJson(e,function(e){if(""!==e){var t;try{t=JSON.parse(e)}catch(n){t=e}return t}})},b.undup=function(e,t){t=t||250;var n=0;return function(){var r=(new Date).getTime();return r-n>t?(n=r,e.apply(this,arguments)):void 0}},b.parseUrl=function(e){var t=document.createElement("a");return t.href=e,""===t.host&&(t.href=t.href),{hash:t.hash,host:t.host,hostname:t.hostname,pathname:t.pathname,protocol:t.protocol,query:b.parseQueryString(t.search)}},b.unparseUrl=function(e){return(e.protocol||"")+"//"+(e.host||"")+(e.pathname||"")+b.unparseQueryString(e.query)+(e.hash||"")},b.equals=function(e,t){var n=function(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty(n))&&!b.equals(e[n],t[n]))return!1;return!0};if(e instanceof Array){if(t instanceof Array){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!b.equals(e[r],t[r]))return!1;return!0}return!1}return e instanceof Object?t instanceof Object&&(n(e,t)&&n(t,e)):e===t},b.isSamePage=function(e,t){return e=e instanceof String?b.parseUrl(e):e,t=t instanceof String?b.parseUrl(t):t,e.protocol===t.protocol&&e.host===t.host&&e.pathname===t.pathname&&b.equals(e.query,t.query)},b.extractHostname=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},b.extractRootDomain=function(e){var t=b.extractHostname(e),n=t.split("."),r=n.length;return r>2&&(t=n[r-2]+"."+n[r-1],2==n[r-1].length&&2==n[r-1].length&&(t=n[r-3]+"."+t)),t},b.qualifyUrl=function(e){var t=document.createElement("div");return t.innerHTML='<a href="'+e.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")+'">x</a>',t.firstChild.href},b.padLeft=function(e,t,n){var r=void 0!==n?n:"0",i=new Array(1+t).join(r);return(i+e).slice(-i.length)},metrixSessionId={},metrixSessionId.uniqueSessionReferrer=function(){return S.referrerPath},metrixSessionId.uniqueMetrixId=function(){return S.userId},metrixSessionId.uniqueSessionNumber=function(){return S.sessionNumber},metrixSessionId.uniqueSessionId=function(){return S.sessionId},metrixSessionId.uniqueLastUseSessionIdTime=function(){return S.sessionLastUs},metrixSessionId.getSessionNumber=function(){return null!=localStorage.getItem(this.uniqueLastUseSessionIdTime())?Number(localStorage.getItem(this.uniqueSessionNumber())):0},metrixSessionId.sessionIsStarted=!1,metrixSessionId.referrerIsFixed=function(){var e=b.parseUrl(document.referrer);return e=e.hostname,location.hostname==e||document.referrer==localStorage.getItem(metrixSessionId.uniqueSessionReferrer())},metrixSessionId.get=function(){if(null!=localStorage.getItem(this.uniqueLastUseSessionIdTime())&&null!=localStorage.getItem(this.uniqueSessionId())&&metrixSessionId.referrerIsFixed()&&Date.parse(Date())-localStorage.getItem(this.uniqueLastUseSessionIdTime())<t.sessionExpireTime)return localStorage.setItem(this.uniqueLastUseSessionIdTime(),Date.parse(Date())),this.sessionIsStarted=!1,localStorage.getItem(this.uniqueSessionId());if(null!=localStorage.getItem(this.uniqueLastUseSessionIdTime())){var e=Number(localStorage.getItem(this.uniqueSessionNumber()));e+=1,localStorage.setItem(this.uniqueSessionNumber(),e.toString())}else localStorage.setItem(this.uniqueSessionNumber(),"0");f=parseInt(localStorage.getItem(this.uniqueSessionNumber()))-1,m=localStorage.getItem(this.uniqueSessionId()),localStorage.setItem(this.uniqueLastUseSessionIdTime(),Date.parse(Date()));var n=b.genGuid();return localStorage.removeItem(metrixSessionId.uniqueMetrixId()),localStorage.setItem(this.uniqueSessionId(),n),localStorage.setItem(this.uniqueSessionReferrer(),document.referrer),this.sessionIsStarted=!0,n},metrixEvent={},function(){var e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;function t(e){i[e]||(p=e),i[e]=!0}try{var n=new e({iceServers:[]}),r=function(){},i={},a=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g;n.createDataChannel(""),n.createOffer().then(function(e){e.sdp.split("\n").forEach(function(e){e.indexOf("candidate")<0||e.match(a).forEach(t)}),n.setLocalDescription(e,r,r)}).catch(function(e){}),n.onicecandidate=function(e){e&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.match(a)&&e.candidate.candidate.match(a).forEach(t)}}catch(e){}}(),metrixEvent.userIdentificationInfo=function(){var e;return null!==h&&(e={deviceLanguage:h.locale.language,platform:h.browser.platform,screen:{height:h.screen.height,width:h.screen.width,color_depth:h.screen.colorDepth},os:{name:h.browser.mobileOs,version:0,version_name:h.browser.mobileOsVersion},cpuCore:h.screen.cpuCore,gpu:h.screen.gpu}),e},metrixEvent.makeBaseEventInfo=function(e){var t,n={};n.user_id=localStorage.getItem(S.metrixId),n.session_id=metrixSessionId.get(),n.session_num=metrixSessionId.getSessionNumber(),n.event_time=(t=new Date).getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()+"T"+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds()+"."+t.getUTCMilliseconds()+"Z";var r=(new Date).getTime();if("session_start"!=e)return w(),n;n.install_info={install_complete_timestamp:r,update_timestamp:r,referrer_url:c},n.sdk_version="0.1.0";var i={};"not recognized"!=p&&(i.localIp=p),null!==h&&(i.protocol=h.document.url.protocol,i.browser_ua=h.browser.ua,i.browser_name=h.browser.name,i.browser_version=h.browser.version);var l=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var r=e.indexOf("Edge/");if(r>0)return parseInt(e.substring(r+5,e.indexOf(".",r)),10);return!1}();return l&&(i.browser_version=l,l>11&&(i.browser_name="MS Edge"),l<=11&&(i.browser_name="MSIE")),null!=i&&(n.connection_info=i),n.device_info=this.userIdentificationInfo(),a.engine_version="0.1.0",a.engine_name="web",n.device_info.android_advertising_id=o,n.geo_info=u,n.app_info=a,n.ip="0.0.0.0",n.attributes={tracker_token:s},w(),n},metrixEvent.sessionStop=function(){var e=this.makeBaseEventInfo("session_stop");return e.session_id=m,e.session_num=f,e.duration_millis=y.diffVisit(),e.event_type="session_stop",e},metrixEvent.sessionStart=function(){var e=this.makeBaseEventInfo("session_start");return e.event_type="session_start",e},metrixEvent.manualTrack=function(e,t,n){var r=metrixEvent.makeBaseEventInfo("custom");return r.event_type="custom",r.slug=n,r.attributes=e,r.metrics=t,r},metrixEvent.mouseClickSubEvent=function(e,t){return[e,t,Date.parse(Date())]},metrixEvent.sendObject=function(e){JSON.parse(e);var t={events:JSON.parse(e)};return JSON.stringify(t)},metrixSubEventQueue={},window.addEventListener("blur",function(){new Date;y.addSessionVisitTime()}),window.addEventListener("focus",function(){y.setSessionLastVisitTime()}),window.addEventListener("beforeunload",function(e){y.addSessionVisitTime(),d!=n.unused&&(localStorage.setItem(S.ajaxState,"stop"),localStorage.removeItem(S.subQueue))},!1),e.prototype.options=function(){return this.options};var T=function(){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS",this.mobileOsVersion=this.searchOsVersion(navigator.userAgent),this.mobileOs=this.searchOs(navigator.userAgent)},searchOsVersion:function(e){for(var t,n,r=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(";"),i=0;i<r.length;i++)(t=r[i].trim()).startsWith("Android")?n=t.split(" ")[1]:t.startsWith("CPU")&&(n=t.split(" ")[3]);return n},searchOs:function(e){for(var t,n,r=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(";"),i=0;i<r.length;i++)(t=r[i].trim()).startsWith("Android")?n=t.split(" ")[0]:t.startsWith("CPU")&&(n=t.split(" ")[1]);return n},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,r=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,n){if(-1!=n.indexOf(e[t].subString))return e[t].identity}else if(r)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPod",identity:"iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};return e.init(),e}(),x={getFormData:function(e){for(var t={},n=function(e,n){""===e&&(e="anonymous");var r=t[e];null!=r?r instanceof Array?t[e].push(n):t[e]=[r,n]:t[e]=n},r=0;r<e.elements.length;r++){var i=e.elements[r],a=i.tagName.toLowerCase();if("input"==a||"textfield"==a)"off"!==(i.getAttribute("autocomplete")||"").toLowerCase()&&"password"!==i.type&&("radio"!==i.type||i.checked)&&n(i.name,i.value);else if("select"==a){var o=i.options[i.selectedIndex];n(i.name,o.value)}}return t},monitorElements:function(e,t,n){n=n||50;var r=function(){for(var i=document.getElementsByTagName(e),a=0;a<i.length;a++){var o=i[a];if(!o.getAttribute("metrix_scanned")){o.setAttribute("metrix_scanned",!0);try{t(o)}catch(e){window.onerror(e)}}}setTimeout(r,n)};setTimeout(r,0)},getDataset:function(e){if(void 0!==e.dataset)return b.toObject(e.dataset);if(e.attributes){for(var t={},n=e.attributes,r=0;r<n.length;r++){var i=n[r].name,a=n[r].value;0===i.indexOf("data-")&&(t[i=i.substr("data-".length)]=a)}return t}return{}},genCssSelector:function(e){return""},getNodeDescriptor:function(e){return{id:e.id,selector:x.genCssSelector(e),title:""===e.title?void 0:e.title,data:x.getDataset(e)}},getAncestors:function(e){for(var t=e,n=[];t&&t!==document.body;)n.push(t),t=t.parentNode;return n}},E={removeElement:function(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r)},toArray:function(e){var t,n=[],r=e.length;for(n.length=e.length,t=0;t<r;t++)n[t]=e[t];return n},contains:function(e,t){return E.exists(e,function(e){return e===t})},diff:function(e,t){var n,r,i=[];for(n=0;n<e.length;n++)r=e[n],E.contains(t,r)||i.push(r);return i},exists:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1},map:function(e,t){var n,r=[];for(n=0;n<e.length;n++)r.push(t(e[n]));return r}},_={getFingerprint:function(){return[JSON.stringify(_.getPluginsData()),JSON.stringify(_.getLocaleData()),navigator.userAgent.toString()].join("")},getBrowserData:function(){_.getFingerprint();return{ua:navigator.userAgent,name:T.browser,version:T.version,platform:T.OS,mobileOs:T.mobileOs||T.OS,mobileOsVersion:T.mobileOsVersion||"unknown version",language:navigator.language||navigator.userLanguage||navigator.systemLanguage,plugins:_.getPluginsData()}},getUrlData:function(){var e=document.location;return i=document.referrer,{hash:e.hash,host:e.host,hostname:e.hostname,pathname:g,protocol:e.protocol,referrer:i,query:b.parseQueryString(e.search)}},getDocumentData:function(){return{title:document.title,referrer:document.referrer&&b.parseUrl(document.referrer)||void 0,url:_.getUrlData()}},getScreenData:function(){return{height:screen.height,width:screen.width,colorDepth:screen.colorDepth,cpuCore:navigator.hardwareConcurrency,gpu:function(){var e=document.createElement("canvas"),t=e.getContext("experimental-webgl")||e.getContext("webgl");if(!t)return"Unknow";var n=t.getExtension("WEBGL_debug_renderer_info");return n?t.getParameter(n.UNMASKED_RENDERER_WEBGL):"Unknow"}()}},getLocaleData:function(){var e,t,n=new RegExp("([A-Z]+-[0-9]+) \\(([A-Z]+)\\)").exec((new Date).toString());return n&&n.length>=3&&(e=n[1],t=n[2]),{language:navigator.systemLanguage||navigator.userLanguage||navigator.language,timezoneOffset:(new Date).getTimezoneOffset(),gmtOffset:e,timezone:t}},getPageloadData:function(){document.location;return{browser:_.getBrowserData(),document:_.getDocumentData(),screen:_.getScreenData(),locale:_.getLocaleData()}},getPluginsData:function(){for(var e=[],t=navigator.plugins,n=0;n<t.length;n++){var r=t[n];e.push({name:r.name,description:r.description,filename:r.filename,version:r.version,mimeType:r.length>0?{type:r[0].type,description:r[0].description,suffixes:r[0].suffixes}:void 0})}return e}},D=function(){this.handlers=[],this.onerror=console&&console.log||window.onerror||function(e){}};D.prototype.push=function(e){this.handlers.push(e)},D.prototype.dispatch=function(){var e,t=Array.prototype.slice.call(arguments,0);for(e=0;e<this.handlers.length;e++)try{this.handlers[e].apply(null,t)}catch(e){onerror(e)}};var O,A,C={};C.onready=function(e){null!=document.body?e():setTimeout(function(){C.onready(e)},10)},C.onevent=function(e,t,n,r){var i=function(e){return function(t){var n;return t||(t=window.event),(t=b.copyFields(t)).target=t.target||t.srcElement,t.keyCode=t.keyCode||t.which||t.charCode,t.which=t.which||t.keyCode,t.charCode="number"==typeof t.which?t.which:t.keyCode,t.timeStamp=t.timeStamp||(new Date).getTime(),t.target&&3==t.target.nodeType&&(t.target=t.target.parentNode),t.preventDefault||(t.preventDefault=function(){n=!1}),e(t)||n}}(r);e.addEventListener?e.addEventListener(t,i,n):e.attachEvent&&e.attachEvent("on"+t,i)},C.onexit=function(){var e=!1,t=new D,n=function(n){e||(t.dispatch(n),e=!0)};C.onevent(window,"unload",void 0,n);var r=function(e){var t=e.onunload||function(e){};e.onunload=function(e){n(),t(e)}};return r(window),C.onready(function(){r(document.body)}),function(e){t.push(e)}}(),C.onengage=(O=new D,A=[],C.onready(function(){C.onevent(document.body,"mouseover",!0,function(e){A.push(e)}),C.onevent(document.body,"mouseout",!0,function(e){var t,n;for(t=A.length-1;t>=0;t--)if(A[t].target===e.target){n=A[t],E.removeElement(A,t);break}if(void 0!==n){var r=e.timeStamp-n.timeStamp;r>=1e3&&r<=2e4&&O.dispatch(n,e)}})}),function(e){O.push(e)}),C.onhashchange=function(){var e=new D,t=document.location.hash,n=function(n){var r=document.location.hash;t!=r&&(t=r,n.hash=r,e.dispatch(n))};return window.onhashchange?C.onevent(window,"hashchange",!1,n):setInterval(function(){n({})},25),function(t){e.push(t)}}(),C.onerror=function(){var e=new D;return"function"==typeof window.onerror&&e.push(window.onerror),window.onerror=function(t,n,r){e.dispatch(t,n,r)},function(t){e.push(t)}}(),C.onsubmit=function(){var e=new D,t=b.undup(function(t){e.dispatch(t)});return C.onready(function(){C.onevent(document.body,"submit",!0,function(e){t(e)}),C.onevent(document.body,"keypress",!1,function(e){if(13==e.keyCode){var n=e.target.form;n&&(e.form=n,t(e))}}),C.onevent(document.body,"click",!1,function(e){var n=e.target,r=(n.type||"").toLowerCase();!n.form||"submit"!==r&&"button"!==r||(e.form=n.form,t(e))})}),function(t){e.push(t)}}(),e.prototype.setChartId=function(e){r=e},e.prototype.initialize=function(e){var t=this;a={package:document.location.hostname?document.location.hostname:document.location.pathname,code:1,version:"1.0"},o=e.uniqueDeviceId||"",s=e.trackerToken,u=e.geoInfo,c=b.getQueryString(document.location.search),this.options=b.merge({bucket:"none",trackLinkClicks:!0},this.options),this.javascriptRedirect=!0,this.context={},t.oldHash=document.location.hash;var n=function(e){if(t.oldHash!==e){var n=e.substring(1),r=document.getElementById(n);b.merge({url:b.parseUrl(document.location)},r?x.getNodeDescriptor(r):{id:n});t.oldHash=e}};if(this.options.trackPageView&&C.onready(function(){t.pageview()}),this.options.trackHashChanges&&C.onhashchange(function(e){n(e.hash)}),this.options.trackLinkClicks){var r=this;x.monitorElements("a",function(e){C.onevent(e,"click",!0,function(i){if(i.isTrusted){var a=i.target;t.javascriptRedirect=!1,setTimeout(function(){t.javascriptRedirect=!0},500);var o=b.parseUrl(e.href);b.merge({url:o},x.getNodeDescriptor(a));b.isSamePage(o,document.location.href)?(t.oldHash=void 0,n(document.location.hash)):r.options.waitOnTracker&&i.preventDefault()}})})}this.options.trackRedirects&&C.onexit(function(e){t.javascriptRedirect}),this.options.trackSubmissions&&C.onsubmit(function(e){e.form&&(e.form.formId||(e.form.formId=b.genGuid()))})},e.prototype.pageview=function(e,t,n){e=e||document.location,h=b.merge(_.getPageloadData(),{url:b.parseUrl(e+"")}),y.setSessionLastVisitTime();metrixSessionId.get();w()};var L={};function N(e){if(!(e.session_num<0)&&null!=r){var t=new Array;null!=localStorage.getItem(S.maneQueue)&&(t=JSON.parse(localStorage.getItem(S.maneQueue))),t.push(e),localStorage.setItem(S.maneQueue,JSON.stringify(t)),L.breakHeavyQueue(),0==L.isQueueEmpty()&&null==localStorage.getItem(S.subQueue)&&U()}}function U(){if(null!=localStorage.getItem(S.maneQueue)&&L.isGoodTimeToSendData())if(localStorage.setItem(S.lastTrySendData,Date.parse(Date())),l<3){l+=1,localStorage.setItem(localStorage.ajaxState,n.start),d=n.start,L.updateSubQueue();var e=Date.parse(Date());!function e(n,i){var a=new XMLHttpRequest;if(localStorage.getItem(S.metrixId)&&null!=localStorage.getItem(S.metrixId)?a.open("POST",t.urlEvents,!0):a.open("POST",t.urlInit,!0),a.setRequestHeader(v.authentication,r),a.setRequestHeader(v.contentType,v.ContentTypeValue),a.timeout=t.timeOut,null!=n)if(localStorage.getItem(S.metrixId)&&null!=localStorage.getItem(S.metrixId))a.addEventListener("readystatechange",function(){if(4==this.readyState)if(this.status>=200&&this.status<=500){l=0,localStorage.setItem(S.lastTimeDataSend,i);try{var e=JSON.parse(this.responseText);"user_id"in e&&I.setMetrixId(e.user_id)}catch(e){}this.status<400&&L.refreshMainQueue()}else console.log("Analytic request Failed with Statuse ",this.status,"."),L.relaxQueue(),U()}),a.send(JSON.stringify(n));else{var o=n[0],s=n.slice(1,n.length);a.addEventListener("readystatechange",function(){if(4==this.readyState)if(this.status>=200&&this.status<=500){l=0,localStorage.setItem(S.lastTimeDataSend,i);try{var t=JSON.parse(this.responseText);if("user_id"in t){var n=t.user_id;I.setMetrixId(n);for(var r=0;r<s.length;r++)s[r].user_id=n}}catch(e){}this.status<400&&L.refreshMainQueue(),s.length>0&&e(s,i)}else console.log("Analytic request Failed with Statuse ",this.status,"."),L.relaxQueue(),U()}),a.send(JSON.stringify(o))}}(JSON.parse(localStorage.getItem(S.subQueue)),e)}else l=0}L.breakHeavyQueue=function(){var e=new Array,n=["session_start","page_view","session_stop","custom"];null!=localStorage.getItem(S.maneQueue)&&(e=JSON.parse(localStorage.getItem(S.maneQueue))),e.length>t.localQueueCapacity&&localStorage.setItem(S.maneQueue,JSON.stringify(function(e){var t,r,i=new Array;for(t=0,r=e.length;t<r;++t){var a=e[t];-1!=n.indexOf(a.event_type)&&i.push(a)}return i}(e)))},L.isQueueEmpty=function(){var e=new Array;return null!=localStorage.getItem(S.maneQueue)&&(e=JSON.parse(localStorage.getItem(S.maneQueue))),!(e.length>t.queueCapacity)},L.relaxQueue=function(){new Array;null!=localStorage.getItem(S.subQueue)&&JSON.parse(localStorage.getItem(S.subQueue)),localStorage.removeItem(S.subQueue),d=n.stop,localStorage.setItem(S.ajaxState,"stop")},L.isGoodTimeToSendData=function(){if(null!=localStorage.getItem(S.lastTimeDataSend)){if(Date.parse(Date())-localStorage.getItem(S.lastTimeDataSend)<t.queueUnloadTime&&this.isQueueEmpty())return!1;if(null!=localStorage.getItem(S.lastTrySendData))Date.parse(Date())-localStorage.getItem(S.lastTrySendData)>3*t.timeOut+t.queueUnloadTime&&(this.relaxQueue(),l=0);else this.relaxQueue(),l=0,localStorage.setItem(S.lastTrySendData,Date.parse(Date()))}return localStorage.getItem(S.ajaxState)!=n.start},L.refreshMainQueue=function(){var e=new Array,t=new Array;null!=localStorage.getItem(S.subQueue)&&(t=JSON.parse(localStorage.getItem(S.subQueue))),null!=localStorage.getItem(S.maneQueue)&&(e=JSON.parse(localStorage.getItem(S.maneQueue))),e.splice(0,t.length),localStorage.removeItem(S.subQueue),0==e.length?localStorage.removeItem(S.maneQueue):localStorage.setItem(S.maneQueue,JSON.stringify(e)),d=n.stop,localStorage.setItem(S.ajaxState,n.stop),0==this.isQueueEmpty()&&U()},L.updateSubQueue=function(){var e=new Array;null!=localStorage.getItem(S.maneQueue)&&(e=JSON.parse(localStorage.getItem(S.maneQueue))),localStorage.setItem(S.subQueue,JSON.stringify(e.slice(0,t.queueCapacity)))},e.prototype.sendCustomTrack=function(e,t,n){n=n||{},t=t||{},N(metrixEvent.manualTrack(t,n,e))},e.prototype.sendRevenue=function(e,t,n,r){var i={_revenue:t},a={_currency:n,_order_id:r};N(metrixEvent.manualTrack(a,i,e))},e.setUserID=function(e){localStorage.setItem(metrixSessionId.uniqueMetrixId(),e)};setInterval(U,t.queueUnloadTime)}(MetrixAnalytics)}